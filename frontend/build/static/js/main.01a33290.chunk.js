(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{25:function(e,t,s){},45:function(e,t,s){"use strict";s.r(t);var r=s(1),a=s.n(r),i=s(18),n=s.n(i),c=(s(25),s(8)),l=s(20),o=s(3),h=s(4),d=s(7),u=s(6),j=s(5),p=function(e){return e.children},b=s(0),m=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(o.a)(this,s),t.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){var e="failed";return"SUCCESS"===this.props.status?e="succeed":"RUNNING"!==this.props.status&&"CREATED"!==this.props.status||(e="running"),Object(b.jsxs)("tr",{className:e,children:[Object(b.jsx)("td",{children:this.props.ID}),Object(b.jsx)("td",{children:this.props.requestedBy}),Object(b.jsx)("td",{children:this.props.createdAt}),Object(b.jsx)("td",{children:this.props.env_name}),Object(b.jsx)("td",{children:this.props.path}),Object(b.jsx)("td",{children:this.props.status}),Object(b.jsx)("td",{children:Object(b.jsx)("a",{href:"#",onClick:this.props.click,children:"View Details"})})]})}}]),s}(r.Component),f=function(e){return e.items.map((function(t){return Object(b.jsx)(m,{ID:t.id,createdAt:t.created_at,env_name:t.env_name,requestedBy:t.requested_by,status:t.status,path:t.displayPath,click:e.clicked.bind(undefined,t.id)},t.id)}))},v=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(o.a)(this,s),t.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){var e=Object(b.jsx)(f,{items:this.props.items,clicked:this.props.viewItemDetails});return Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("legend",{children:"Test execution requests"}),Object(b.jsx)("div",{className:"table-responsive",children:Object(b.jsxs)("table",{className:"table table-striped",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Request ID"}),Object(b.jsx)("th",{children:"Requested By"}),Object(b.jsx)("th",{children:"Created At"}),Object(b.jsx)("th",{children:"Test Env"}),Object(b.jsx)("th",{children:"Test Path"}),Object(b.jsx)("th",{children:"Status"}),Object(b.jsx)("th",{children:"Details"})]})}),Object(b.jsx)("tbody",{"aria-label":"textExecution-table",children:e})]})})]})})})}}]),s}(r.Component),O=s(19),x=s.n(O).a.create({baseURL:"http://127.0.0.1:8081/api/v1/"}),g=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(o.a)(this,s),t.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){var e="failed";return"SUCCESS"===this.props.currentItem.status?e="succeed":"RUNNING"!==this.props.currentItem.status&&"CREATED"!==this.props.currentItem.status||(e="running"),Object(b.jsxs)(p,{children:[Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsx)("a",{className:"btn btn-primary float-right",href:"#",onClick:this.props.backClicked.bind(this),children:"Back"})})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("legend",{children:"Test details"}),Object(b.jsx)("div",{className:"table-responsive",children:Object(b.jsx)("table",{className:"table table-striped",children:Object(b.jsxs)("tbody",{children:[Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"title",children:"ID"}),Object(b.jsx)("td",{children:this.props.currentItem.id})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"title",children:"Requested by"}),Object(b.jsx)("td",{children:this.props.currentItem.requested_by})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"title",children:"Env"}),Object(b.jsx)("td",{children:this.props.currentItem.env_name})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"title",children:"Path"}),Object(b.jsx)("td",{children:this.props.currentItem.displayPath})]}),Object(b.jsxs)("tr",{className:e,children:[Object(b.jsx)("td",{className:"title",children:"Status"}),Object(b.jsx)("td",{children:this.props.currentItem.status})]}),Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"title",children:"Logs"}),Object(b.jsx)("td",{children:Object(b.jsx)("pre",{children:Object(b.jsx)("code",{className:"python",children:this.props.currentItem.logs})})})]})]})})})]})})})]})}}]),s}(r.Component),N=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){return Object(o.a)(this,s),t.apply(this,arguments)}return Object(h.a)(s,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("div",{className:"col-md-12",children:Object(b.jsxs)("fieldset",{children:[Object(b.jsx)("legend",{children:"New request"}),Object(b.jsx)("form",{onSubmit:this.props.submitTest.bind(this),children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsxs)("div",{className:"col-md-2 form-group",children:[Object(b.jsx)("input",{type:"text",className:"form-control","aria-label":"requester-input",name:"requester",id:"requester",placeholder:"Requester",value:this.props.requester,onChange:this.props.requesterChanged.bind(this)}),Object(b.jsx)("p",{className:"error-message",children:this.props.requesterError})]}),Object(b.jsxs)("div",{className:"col-md-2 form-group",children:[Object(b.jsxs)("select",{className:"form-control","aria-label":"env-input",name:"env_id",id:"env_id",placeholder:"Environment ID",value:this.props.env,onChange:this.props.envChanged.bind(this),children:[Object(b.jsx)("option",{value:"",defaultValue:!0}),this.props.assets.test_envs.map((function(e,t){return Object(b.jsx)("option",{value:e.id,"aria-label":"env#".concat(t),children:e.name},e.id)}))]}),Object(b.jsx)("p",{className:"error-message",children:this.props.envError})]}),Object(b.jsxs)("div",{className:"col-md-4 form-group",children:[Object(b.jsxs)("select",{className:"form-control","aria-label":"testPath-input",name:"test_path",id:"test_path",multiple:!0,placeholder:"Test Path",value:this.props.testPath,onChange:this.props.testPathChanged.bind(this),children:[Object(b.jsx)("option",{value:"",defaultValue:!0}),this.props.assets.available_paths.map((function(e,t){return Object(b.jsx)("option",{value:e.id,"aria-label":"path#".concat(t),children:e.path},e.id)}))]}),Object(b.jsx)("p",{className:"error-message",children:this.props.testPathError}),Object(b.jsx)("label",{"aria-label":"file-input",children:"Upload Test File:"}),Object(b.jsx)("input",{type:"file",className:"form-control-file",accept:".py",onChange:this.props.fileUploadChanged.bind(this)}),this.props.fileWarnings.map((function(e){return Object(b.jsx)("p",{className:"warning-message",children:e})})),this.props.fileErrors.map((function(e){return Object(b.jsx)("p",{className:"error-message",children:e})}))]}),Object(b.jsx)("div",{className:"col-md-2",children:Object(b.jsx)("input",{type:"submit","aria-label":"submit-input",value:"Submit",className:"btn btn-primary",disabled:!this.props.testPath.length&&!this.props.file||""===this.props.requester||""===this.props.env})})]})})]})})})}}]),s}(r.Component),y=function(e){Object(u.a)(s,e);var t=Object(j.a)(s);function s(){var e;Object(o.a)(this,s);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).state={assets:{test_envs:[],available_paths:[]},error:!1,items:[],detailsView:!1,itemID:null,currentItem:{},requesterError:"",envError:"",testPathError:"",requester:"",env:"",testPath:[],file:null,fileErrors:[],fileWarnings:[]},e.interval=null,e.getAssets=function(){x.get("assets").then((function(t){e.setState({assets:t.data})})).catch((function(t){e.setState({error:!0})}))},e.getDisplayPath=function(t){var s="";return e.state.assets.available_paths.map((function(e){t.some((function(t){return t===e.id}))&&(s+=e.path+" ")})),s},e.refreshList=function(){x.get("test-run").then((function(t){var s=t.data;e.setState({items:s.map((function(t){return Object(l.a)({displayPath:e.getDisplayPath(t.path)},t)}))})})).catch((function(t){e.setState({error:!0})})),null!==e.state.itemID&&e.viewItemDetails(e.state.itemID)},e.submitTest=function(t){t.preventDefault(),x.post("test-run",{requested_by:e.state.requester,env:e.state.env,path:e.state.testPath,file:e.state.file}).then((function(s){t.target.reset(),e.state.file&&e.getAssets(),e.setState({requester:"",env:"",testPath:[],file:null,fileWarnings:[],fileErrors:[],requesterError:"",envError:"",testPathError:""}),e.refreshList()})).catch((function(t){var s,r,a;e.setState({requesterError:null!==(s=t.response.data.requested_by)&&void 0!==s?s:"",envError:null!==(r=t.response.data.env)&&void 0!==r?r:"",testPathError:null!==(a=t.response.data.path)&&void 0!==a?a:""})}))},e.viewItemDetails=function(t){x.get("test-run/"+t).then((function(t){var s=t.data;s.displayPath=e.getDisplayPath(t.data.path),e.setState({currentItem:s})})).catch((function(t){e.setState({error:!0})})),e.setState({detailsView:!0,itemID:t})},e.backToListItems=function(){e.setState({detailsView:!1,itemID:null})},e.handleTestPathChanged=function(t){for(var s=t.target.options,r=[],a=0,i=s.length;a<i;a++)s[a].selected&&r.push(s[a].value);e.setState({testPath:r})},e.handleFileUploadChanged=function(t){e.setState({fileErrors:[],fileWarnings:[]});var s=t.target.files[0],r=s.name;if(!r.startsWith("test"))return e.setState({fileErrors:[].concat(Object(c.a)(e.state.fileErrors),["File name must start with the world 'test'"])}),!1;if(s.size>5e3)return e.setState({fileErrors:[].concat(Object(c.a)(e.state.fileErrors),["Please upload a file smaller than 5 MB"])}),!1;var a=e.state.assets.available_paths.filter((function(e){return e.path.split("/")[1].indexOf(r.split(".")[0])>-1})).length;a&&(r=[[r.split(".")[0],a].join("_"),r.split(".")[1]].join("."),e.setState({fileWarnings:[].concat(Object(c.a)(e.state.fileWarnings),["file already exists. a new name will be assigned: "+r])}));var i=new FileReader;i.onload=function(e){this.setState({file:{name:r,data:e.target.result.split(",")[1]}})}.bind(Object(d.a)(e)),i.readAsDataURL(s)},e}return Object(h.a)(s,[{key:"componentDidMount",value:function(){this.getAssets(),this.interval=setInterval(this.refreshList,1e3),this.refreshList()}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this;return this.state.detailsView?Object(b.jsx)(g,{currentItem:this.state.currentItem,backClicked:this.backToListItems}):Object(b.jsxs)(p,{children:[Object(b.jsx)(N,{requester:this.state.requester,requesterError:this.state.requesterError,env:this.state.env,envError:this.state.envError,testPath:this.state.testPath,testPathError:this.state.testPathError,fileErrors:this.state.fileErrors,fileWarnings:this.state.fileWarnings,assets:this.state.assets,file:this.state.file,requesterChanged:function(t){var s;return e.setState({requester:null===(s=t.target.value)||void 0===s?void 0:s.toString()})},envChanged:function(t){var s;return e.setState({env:null===(s=t.target.value)||void 0===s?void 0:s.toString()})},testPathChanged:this.handleTestPathChanged,fileUploadChanged:this.handleFileUploadChanged,submitTest:this.submitTest}),Object(b.jsx)(v,{items:this.state.items,viewItemDetails:this.viewItemDetails})]})}}]),s}(r.Component);var E=function(){return Object(b.jsx)("div",{children:Object(b.jsx)(y,{})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(E,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[45,1,2]]]);
//# sourceMappingURL=main.01a33290.chunk.js.map